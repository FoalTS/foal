"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9981],{72839:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var r=t(74848),s=t(28453);const o={title:"Les Mod\xe8les User et Story",id:"tuto-3-the-models",slug:"3-the-models"},l=void 0,i={id:"tutorials/real-world-example-with-react/tuto-3-the-models",title:"Les Mod\xe8les User et Story",description:"Maintenant que la connexion \xe0 la base de donn\xe9es est \xe9tablie, vous pouvez cr\xe9er vos deux entit\xe9s User et Story.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/tutorials/real-world-example-with-react/3-the-models.md",sourceDirName:"tutorials/real-world-example-with-react",slug:"/tutorials/real-world-example-with-react/3-the-models",permalink:"/fr/docs/tutorials/real-world-example-with-react/3-the-models",draft:!1,unlisted:!1,editUrl:"https://github.com/FoalTS/foal/edit/master/docs/docs/tutorials/real-world-example-with-react/3-the-models.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Les Mod\xe8les User et Story",id:"tuto-3-the-models",slug:"3-the-models"},sidebar:"someSidebar",previous:{title:"Base de Donn\xe9es (configuration)",permalink:"/fr/docs/tutorials/real-world-example-with-react/2-database-set-up"},next:{title:"Les Scripts Shell",permalink:"/fr/docs/tutorials/real-world-example-with-react/4-the-shell-scripts"}},a={},d=[{value:"Le Mod\xe8le <code>User</code>",id:"le-mod\xe8le-user",level:2},{value:"Le Mod\xe8le <code>Story</code>",id:"le-mod\xe8le-story",level:2},{value:"Ex\xe9cuter les Migrations",id:"ex\xe9cuter-les-migrations",level:2}];function c(e){const n={blockquote:"blockquote",code:"code",em:"em",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["Maintenant que la connexion \xe0 la base de donn\xe9es est \xe9tablie, vous pouvez cr\xe9er vos deux entit\xe9s ",(0,r.jsx)(n.code,{children:"User"})," et ",(0,r.jsx)(n.code,{children:"Story"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["L'entit\xe9 ",(0,r.jsx)(n.code,{children:"User"})," sera le mod\xe8le utilis\xe9 par le framework pour identifier les utilisateurs et l'entit\xe9 ",(0,r.jsx)(n.code,{children:"Story"})," repr\xe9sentera les posts des utilisateurs."]}),"\n",(0,r.jsxs)(n.h2,{id:"le-mod\xe8le-user",children:["Le Mod\xe8le ",(0,r.jsx)(n.code,{children:"User"})]}),"\n",(0,r.jsxs)(n.p,{children:["Ouvrez le fichier ",(0,r.jsx)(n.code,{children:"user.entity.ts"})," du r\xe9pertoire ",(0,r.jsx)(n.code,{children:"entities"})," et ajoutez quatre nouvelles propri\xe9t\xe9s \xe0 votre mod\xe8le : ",(0,r.jsx)(n.code,{children:"email"}),", ",(0,r.jsx)(n.code,{children:"password"}),", ",(0,r.jsx)(n.code,{children:"name"})," et ",(0,r.jsx)(n.code,{children:"avatar"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["La colonne ",(0,r.jsx)(n.code,{children:"avatar"})," contiendra les chemins vers les images de profil."]}),"\n",(0,r.jsxs)(n.p,{children:["Vous devrez \xe9galement exporter un mod\xe8le suppl\xe9mentaire ",(0,r.jsx)(n.code,{children:"DatabaseSession"})," du paquet ",(0,r.jsx)(n.code,{children:"@foal/typeorm"}),". Vous n'avez pas besoin de vous en pr\xe9occuper maintenant, il sera utilis\xe9 plus tard dans le tutoriel lorsque vous ajouterez l'authentification."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { BaseEntity, Column, Entity, PrimaryGeneratedColumn } from 'typeorm';\n\n@Entity()\nexport class User extends BaseEntity {\n\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column({ unique: true })\n  email: string;\n\n  @Column()\n  password: string;\n\n  @Column()\n  name: string;\n\n  @Column()\n  avatar: string;\n\n}\n\n// This line is required. It will be used to create the SQL session table later in the tutorial.\nexport { DatabaseSession } from '@foal/typeorm';\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"le-mod\xe8le-story",children:["Le Mod\xe8le ",(0,r.jsx)(n.code,{children:"Story"})]}),"\n",(0,r.jsx)(n.p,{children:"Cr\xe9ez ensuite votre deuxi\xe8me entit\xe9."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"foal generate entity story\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Ouvrez le nouveau fichier et ajoutez trois nouvelles propri\xe9t\xe9s : ",(0,r.jsx)(n.code,{children:"author"}),", ",(0,r.jsx)(n.code,{children:"title"})," et ",(0,r.jsx)(n.code,{children:"link"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { BaseEntity, Column, Entity, ManyToOne, PrimaryGeneratedColumn } from 'typeorm';\nimport { User } from './user.entity';\n\n@Entity()\nexport class Story extends BaseEntity {\n\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @ManyToOne(type => User, { nullable: false })\n  author: User;\n\n  @Column()\n  title: string;\n\n  @Column()\n  link: string;\n\n}\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Par d\xe9faut, TypeORM permet aux relations ",(0,r.jsx)(n.em,{children:"many-to-one"})," d'\xeatre nullables. L'option pass\xe9e au d\xe9corateur sp\xe9cifie que celle-ci ne peut pas l'\xeatre."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"ex\xe9cuter-les-migrations",children:"Ex\xe9cuter les Migrations"}),"\n",(0,r.jsx)(n.p,{children:"Enfin, cr\xe9ez les tables dans la base de donn\xe9es. G\xe9n\xe9rez les migrations \xe0 partir des entit\xe9s et ex\xe9cutez-les."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm run makemigrations\nnpm run migrations\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Trois nouvelles tables sont ajout\xe9es \xe0 la base de donn\xe9es : les tables ",(0,r.jsx)(n.code,{children:"user"})," et ",(0,r.jsx)(n.code,{children:"story"})," et une table ",(0,r.jsx)(n.code,{children:"sessions"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"+------------+-----------+-------------------------------------+\n|                             user                             |\n+------------+-----------+-------------------------------------+\n| id         | integer   | PRIMARY KEY AUTO_INCREMENT NOT NULL |\n| email      | varchar   | UNIQUE NOT NULL                     |\n| password   | varchar   | NOT NULL                            |\n| name       | varchar   | NOT NULL                            |\n| avatar     | varchar   | NOT NULL                            |\n+------------+-----------+-------------------------------------+\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"+------------+-----------+-------------------------------------+\n|                             story                            |\n+------------+-----------+-------------------------------------+\n| id         | integer   | PRIMARY KEY AUTO_INCREMENT NOT NULL |\n| authorId   | integer   | NOT NULL                            |\n| title      | varchar   | NOT NULL                            |\n| link       | varchar   | NOT NULL                            |\n+------------+-----------+-------------------------------------+\n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>i});var r=t(96540);const s={},o=r.createContext(s);function l(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);