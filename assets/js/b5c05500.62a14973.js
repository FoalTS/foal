"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[63],{85327:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>d});var o=n(74848),r=n(28453);const l={title:"Production Build",id:"tuto-14-production-build",slug:"14-production-build"},i=void 0,s={id:"tutorials/real-world-example-with-react/tuto-14-production-build",title:"Production Build",description:"So far, the front-end and back-end applications are compiled and served by two different development servers. The next step is to build them into a single one ready for production.",source:"@site/versioned_docs/version-3.x/tutorials/real-world-example-with-react/14-production-build.md",sourceDirName:"tutorials/real-world-example-with-react",slug:"/tutorials/real-world-example-with-react/14-production-build",permalink:"/docs/3.x/tutorials/real-world-example-with-react/14-production-build",draft:!1,unlisted:!1,editUrl:"https://github.com/FoalTS/foal/edit/master/docs/versioned_docs/version-3.x/tutorials/real-world-example-with-react/14-production-build.md",tags:[],version:"3.x",sidebarPosition:14,frontMatter:{title:"Production Build",id:"tuto-14-production-build",slug:"14-production-build"},sidebar:"someSidebar",previous:{title:"CSRF Protection",permalink:"/docs/3.x/tutorials/real-world-example-with-react/13-csrf"},next:{title:"Social Auth with Google",permalink:"/docs/3.x/tutorials/real-world-example-with-react/15-social-auth"}},a={},d=[{value:"Building the React app",id:"building-the-react-app",level:2},{value:"Preventing 404 errors",id:"preventing-404-errors",level:2},{value:"Building the Foal app",id:"building-the-foal-app",level:2}];function c(e){const t={a:"a",blockquote:"blockquote",code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:"So far, the front-end and back-end applications are compiled and served by two different development servers. The next step is to build them into a single one ready for production."}),"\n",(0,o.jsx)(t.h2,{id:"building-the-react-app",children:"Building the React app"}),"\n",(0,o.jsx)(t.p,{children:"In your frontend directory, run the following command:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:"npm run build\n"})}),"\n",(0,o.jsxs)(t.p,{children:["This command builds the React application for production and saves the files in the ",(0,o.jsx)(t.code,{children:"build"})," directory."]}),"\n",(0,o.jsxs)(t.p,{children:["Open it and copy all its contents to the ",(0,o.jsx)(t.code,{children:"public"})," directory of your Foal application."]}),"\n",(0,o.jsxs)(t.blockquote,{children:["\n",(0,o.jsxs)(t.p,{children:["When you use ",(0,o.jsx)(t.code,{children:"foal connect"})," with Angular or Vue, the frontend build will automatically save the files in ",(0,o.jsx)(t.code,{children:"public"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["Now, if you navigate to ",(0,o.jsx)(t.a,{href:"http://localhost:3001",children:"http://localhost:3001"}),", you will see the frontend application served by the backend server."]}),"\n",(0,o.jsx)(t.h2,{id:"preventing-404-errors",children:"Preventing 404 errors"}),"\n",(0,o.jsxs)(t.p,{children:["Open the link ",(0,o.jsx)(t.a,{href:"http://localhost:3001/login",children:"http://localhost:3001/login"})," in a new tab. The server returns a 404 error."]}),"\n",(0,o.jsxs)(t.p,{children:["This is perfectly normal. At the moment, the server does not have a handler for the ",(0,o.jsx)(t.code,{children:"/login"})," route and therefore returns this error. Previously, this problem was handled by the React development server, which is why there was no such error."]}),"\n",(0,o.jsx)(t.p,{children:"To solve this problem, you will add a controller method that will process unhandled requests."}),"\n",(0,o.jsxs)(t.p,{children:["Open ",(0,o.jsx)(t.code,{children:"app.controller.ts"})," and update its contents."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-typescript",children:"import { Context, controller, Get, HttpResponseNotFound, IAppController, render } from '@foal/core';\n\nimport { ApiController, OpenapiController } from './controllers';\n\nexport class AppController implements IAppController {\n  subControllers = [\n    controller('/api', ApiController),\n    controller('/swagger', OpenapiController)\n  ];\n\n  @Get('*')\n  renderApp(ctx: Context) {\n    if (!ctx.request.accepts('html')) {\n      return new HttpResponseNotFound();\n    }\n\n    return render('./public/index.html');\n  }\n}\n\n"})}),"\n",(0,o.jsx)(t.p,{children:"This method returns the React application for any GET request that accepts HTML content and has not been handled by the other methods of the controller and its subcontrollers."}),"\n",(0,o.jsxs)(t.p,{children:["If you return to ",(0,o.jsx)(t.a,{href:"http://localhost:3001/login",children:"http://localhost:3001/login"})," and refresh the page, the login page should display."]}),"\n",(0,o.jsx)(t.h2,{id:"building-the-foal-app",children:"Building the Foal app"}),"\n",(0,o.jsxs)(t.p,{children:["Now, if you want to build the backend application so that you don't use the ",(0,o.jsx)(t.code,{children:"npm run dev"})," option, you can run this command:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:"npm run build\n"})}),"\n",(0,o.jsx)(t.p,{children:"Then, to launch the application, simply execute the following:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:"npm run start\n"})})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>s});var o=n(96540);const r={},l=o.createContext(r);function i(e){const t=o.useContext(l);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(l.Provider,{value:t},e.children)}}}]);