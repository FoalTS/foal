"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2183],{7636:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"deployment-and-environments/ship-to-production","title":"Ship to Production","description":"1. Set the Node.JS environment to production","source":"@site/versioned_docs/version-1.x/deployment-and-environments/ship-to-production.md","sourceDirName":"deployment-and-environments","slug":"/deployment-and-environments/ship-to-production","permalink":"/docs/1.x/deployment-and-environments/ship-to-production","draft":false,"unlisted":false,"editUrl":"https://github.com/FoalTS/foal/edit/master/docs/versioned_docs/version-1.x/deployment-and-environments/ship-to-production.md","tags":[],"version":"1.x","frontMatter":{"title":"Ship to Production"},"sidebar":"someSidebar","previous":{"title":"Configuration","permalink":"/docs/1.x/deployment-and-environments/configuration"}}');var i=t(74848),r=t(28453);const s={title:"Ship to Production"},d=void 0,c={},a=[{value:"1. Set the Node.JS environment to <code>production</code>",id:"1-set-the-nodejs-environment-to-production",level:2},{value:"2. Use HTTPS",id:"2-use-https",level:2},{value:"3. Generate Different Secrets",id:"3-generate-different-secrets",level:2},{value:"4. Database Credentials &amp; Migrations",id:"4-database-credentials--migrations",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.h2,{id:"1-set-the-nodejs-environment-to-production",children:["1. Set the Node.JS environment to ",(0,i.jsx)(n.code,{children:"production"})]}),"\n",(0,i.jsxs)(n.p,{children:["Set the ",(0,i.jsx)(n.code,{children:"NODE_ENV"})," environment variable to ",(0,i.jsx)(n.code,{children:"production"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"NODE_ENV=production npm run start\n"})}),"\n",(0,i.jsx)(n.h2,{id:"2-use-https",children:"2. Use HTTPS"}),"\n",(0,i.jsxs)(n.p,{children:["You must use HTTPS to prevent ",(0,i.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Man-in-the-middle_attack",children:"man-in-the-middle attacks"}),". Otherwise, your credentials and authentication tokens will appear in clear on the network."]}),"\n",(0,i.jsxs)(n.p,{children:["If you use cookies, make sure to let them only be sent to the server when the request is made using SSL. You can do such thing with the cookie ",(0,i.jsx)(n.code,{children:"secure"})," directive."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"config/production.yml (example)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"settings:\n  // If you use sessions\n  session:\n    cookie:\n      secure: true\n  // If you use CSRF protection with cookies\n  csrf:\n    cookie:\n      secure: true\n"})}),"\n",(0,i.jsx)(n.h2,{id:"3-generate-different-secrets",children:"3. Generate Different Secrets"}),"\n",(0,i.jsxs)(n.p,{children:["Use different secrets for your production environment (JWT, session, csrf, etc). Specify them using environment variables or a ",(0,i.jsx)(n.code,{children:".env"})," file."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:".env (example)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"SETTINGS_SESSION_SECRET=ctpQxVTme8rA1SR1AnKHTd/FknqcrhpPlMPGVMSSgjk\nSETTINGS_CSRF_SECRET=PZFo9stbQtGvQ2clYSrgn+FUjf55pjajHJslRaBRNo4\nSETTINGS_JWT_SECRET_OR_PUBLIC_KEY=YZP0iv6gM+VBTxk61l8nKUno2QxsQHO9hm8XfeedZUw\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can generate 256-bit secrets encoded in base64 with the following command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"foal createsecret\n"})}),"\n",(0,i.jsx)(n.h2,{id:"4-database-credentials--migrations",children:"4. Database Credentials & Migrations"}),"\n",(0,i.jsxs)(n.p,{children:["Use different credentials for your production database. Specify them using environment variables or a ",(0,i.jsx)(n.code,{children:".env"})," file."]}),"\n",(0,i.jsx)(n.p,{children:"If you use database migrations, run them on your production server with the following command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"npm run migration:run\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>d});var o=t(96540);const i={},r=o.createContext(i);function s(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);