"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3514],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>h});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var p=n.createContext({}),u=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},s=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,l=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),s=u(r),h=o,m=s["".concat(p,".").concat(h)]||s[h]||d[h]||l;return r?n.createElement(m,a(a({ref:t},c),{},{components:r})):n.createElement(m,a({ref:t},c))}));function h(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=r.length,a=new Array(l);a[0]=s;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:o,a[1]=i;for(var u=2;u<l;u++)a[u]=r[u];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}s.displayName="MDXCreateElement"},5900:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>u});var n=r(87462),o=(r(67294),r(3905));const l={title:"Production Build",id:"tuto-14-production-build",slug:"14-production-build"},a=void 0,i={unversionedId:"tutorials/real-world-example-with-react/tuto-14-production-build",id:"tutorials/real-world-example-with-react/tuto-14-production-build",title:"Production Build",description:"So far, the front-end and back-end applications are compiled and served by two different development servers. The next step is to build them into a single one ready for production.",source:"@site/docs/tutorials/real-world-example-with-react/14-production-build.md",sourceDirName:"tutorials/real-world-example-with-react",slug:"/tutorials/real-world-example-with-react/14-production-build",permalink:"/docs/tutorials/real-world-example-with-react/14-production-build",draft:!1,editUrl:"https://github.com/FoalTS/foal/edit/master/docs/docs/tutorials/real-world-example-with-react/14-production-build.md",tags:[],version:"current",sidebarPosition:14,frontMatter:{title:"Production Build",id:"tuto-14-production-build",slug:"14-production-build"},sidebar:"someSidebar",previous:{title:"CSRF Protection",permalink:"/docs/tutorials/real-world-example-with-react/13-csrf"},next:{title:"Social Auth with Google",permalink:"/docs/tutorials/real-world-example-with-react/15-social-auth"}},p={},u=[{value:"Building the React app",id:"building-the-react-app",level:2},{value:"Preventing 404 errors",id:"preventing-404-errors",level:2},{value:"Building the Foal app",id:"building-the-foal-app",level:2}],c={toc:u};function d(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"So far, the front-end and back-end applications are compiled and served by two different development servers. The next step is to build them into a single one ready for production."),(0,o.kt)("h2",{id:"building-the-react-app"},"Building the React app"),(0,o.kt)("p",null,"In your frontend directory, run the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm run build\n")),(0,o.kt)("p",null,"This command builds the React application for production and saves the files in the ",(0,o.kt)("inlineCode",{parentName:"p"},"build")," directory."),(0,o.kt)("p",null,"Open it and copy all its contents to the ",(0,o.kt)("inlineCode",{parentName:"p"},"public")," directory of your Foal application."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"When you use ",(0,o.kt)("inlineCode",{parentName:"p"},"foal connect")," with Angular or Vue, the frontend build will automatically save the files in ",(0,o.kt)("inlineCode",{parentName:"p"},"public"),".")),(0,o.kt)("p",null,"Now, if you navigate to ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:3001"},"http://localhost:3001"),", you will see the frontend application served by the backend server."),(0,o.kt)("h2",{id:"preventing-404-errors"},"Preventing 404 errors"),(0,o.kt)("p",null,"Open the link ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:3001/login"},"http://localhost:3001/login")," in a new tab. The server returns a 404 error."),(0,o.kt)("p",null,"This is perfectly normal. At the moment, the server does not have a handler for the ",(0,o.kt)("inlineCode",{parentName:"p"},"/login")," route and therefore returns this error. Previously, this problem was handled by the React development server, which is why there was no such error."),(0,o.kt)("p",null,"To solve this problem, you will add a controller method that will process unhandled requests."),(0,o.kt)("p",null,"Open ",(0,o.kt)("inlineCode",{parentName:"p"},"app.controller.ts")," and update its contents."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Context, controller, Get, HttpResponseNotFound, IAppController, render } from '@foal/core';\n\nimport { ApiController, OpenapiController } from './controllers';\n\nexport class AppController implements IAppController {\n  subControllers = [\n    controller('/api', ApiController),\n    controller('/swagger', OpenapiController)\n  ];\n\n  @Get('*')\n  renderApp(ctx: Context) {\n    if (!ctx.request.accepts('html')) {\n      return new HttpResponseNotFound();\n    }\n\n    return render('./public/index.html');\n  }\n}\n\n")),(0,o.kt)("p",null,"This method returns the React application for any GET request that accepts HTML content and has not been handled by the other methods of the controller and its subcontrollers."),(0,o.kt)("p",null,"If you return to ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:3001/login"},"http://localhost:3001/login")," and refresh the page, the login page should display."),(0,o.kt)("h2",{id:"building-the-foal-app"},"Building the Foal app"),(0,o.kt)("p",null,"Now, if you want to build the backend application so that you don't use the ",(0,o.kt)("inlineCode",{parentName:"p"},"npm run dev")," option, you can run this command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm run build\n")),(0,o.kt)("p",null,"Then, to launch the application, simply execute the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm run start\n")))}d.isMDXComponent=!0}}]);